<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  let tg = null;

  if (window.Telegram && window.Telegram.WebApp) {
    tg = window.Telegram.WebApp;
    tg.expand();
  }

  const map = L.map('map').setView([41.7151, 44.8271], 12);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; OpenStreetMap'
  }).addTo(map);

  let marker;

  map.on('click', function (e) {
    if (marker) map.removeLayer(marker);
    marker = L.marker(e.latlng).addTo(map);

    if (tg) {
      tg.sendData(JSON.stringify({
        lat: e.latlng.lat,
        lon: e.latlng.lng
      }));
    }

    alert("დანიშნულება მონიშნულია ✅");
  });
</script>
